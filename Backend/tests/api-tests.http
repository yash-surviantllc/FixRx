### FixRx API Testing Suite
### Use this file with REST Client extensions (Thunder Client, REST Client for VS Code)
### Base URL
@baseUrl = http://localhost:3000/api/v1
@contentType = application/json

### Variables for testing
@testEmail = test@example.com
@testPassword = TestPassword123!
@testPhone = +1234567890
@vendorEmail = vendor@example.com
@consumerEmail = consumer@example.com

###############################################################################
### 1. HEALTH CHECK
###############################################################################

### Health Check
GET http://localhost:3000/health

### API Root
GET http://localhost:3000/

###############################################################################
### 2. AUTHENTICATION ENDPOINTS
###############################################################################

### Register Consumer
POST {{baseUrl}}/auth/register
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "password": "{{testPassword}}",
  "firstName": "Test",
  "lastName": "Consumer",
  "phone": "{{testPhone}}",
  "role": "CONSUMER"
}

### Register Vendor
POST {{baseUrl}}/auth/register
Content-Type: {{contentType}}

{
  "email": "{{vendorEmail}}",
  "password": "{{testPassword}}",
  "firstName": "Test",
  "lastName": "Vendor",
  "phone": "+1234567891",
  "role": "VENDOR",
  "businessName": "Test Vendor Business",
  "businessDescription": "A test vendor for API testing",
  "serviceCategories": ["plumbing", "electrical"]
}

### Login Consumer
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "password": "{{testPassword}}"
}

### Login Vendor
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "{{vendorEmail}}",
  "password": "{{testPassword}}"
}

### Refresh Token (requires valid refresh token)
POST {{baseUrl}}/auth/refresh
Content-Type: {{contentType}}

{
  "refreshToken": "your-refresh-token-here"
}

### Logout (requires Authorization header)
POST {{baseUrl}}/auth/logout
Authorization: Bearer your-jwt-token-here

### Request Password Reset
POST {{baseUrl}}/auth/forgot-password
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}"
}

### Verify Email (requires verification token)
POST {{baseUrl}}/auth/verify-email
Content-Type: {{contentType}}

{
  "token": "verification-token-here"
}

### Verify Phone (requires verification code)
POST {{baseUrl}}/auth/verify-phone
Content-Type: {{contentType}}

{
  "phone": "{{testPhone}}",
  "code": "123456"
}

###############################################################################
### 3. USER MANAGEMENT ENDPOINTS
###############################################################################

### Get Current User Profile (requires Authorization)
GET {{baseUrl}}/users/profile
Authorization: Bearer your-jwt-token-here

### Update User Profile (requires Authorization)
PUT {{baseUrl}}/users/profile
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "firstName": "Updated",
  "lastName": "Name",
  "phone": "+1234567892"
}

### Change Password (requires Authorization)
PUT {{baseUrl}}/users/change-password
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "currentPassword": "{{testPassword}}",
  "newPassword": "NewPassword123!"
}

### Delete User Account (requires Authorization)
DELETE {{baseUrl}}/users/profile
Authorization: Bearer your-jwt-token-here

###############################################################################
### 4. VENDOR ENDPOINTS
###############################################################################

### Search Vendors (Public)
GET {{baseUrl}}/vendors/search?query=plumber&lat=40.7128&lng=-74.0060&radius=50&page=1&limit=10

### Get Vendor Categories (Public)
GET {{baseUrl}}/vendors/categories/list

### Get Featured Vendors (Public)
GET {{baseUrl}}/vendors/featured/list?limit=10

### Get Nearby Vendors (Public)
GET {{baseUrl}}/vendors/nearby/40.7128/-74.0060?radius=25&categories=plumbing,electrical

### Get Vendor by ID (Public)
GET {{baseUrl}}/vendors/vendor-id-here

### Get Vendor Profile (requires Authorization - Vendor only)
GET {{baseUrl}}/vendors/profile/me
Authorization: Bearer your-vendor-jwt-token-here

### Update Vendor Profile (requires Authorization - Vendor only)
PUT {{baseUrl}}/vendors/profile/me
Authorization: Bearer your-vendor-jwt-token-here
Content-Type: {{contentType}}

{
  "businessName": "Updated Business Name",
  "businessDescription": "Updated description",
  "serviceCategories": ["plumbing", "electrical", "hvac"],
  "hourlyRate": 75.00,
  "address": "123 Main St, New York, NY 10001",
  "latitude": 40.7128,
  "longitude": -74.0060
}

### Get Vendor Analytics (requires Authorization - Vendor only)
GET {{baseUrl}}/vendors/analytics/overview
Authorization: Bearer your-vendor-jwt-token-here

### Get Vendor Connections (requires Authorization - Vendor only)
GET {{baseUrl}}/vendors/connections/list?status=CONNECTED&page=1&limit=20
Authorization: Bearer your-vendor-jwt-token-here

###############################################################################
### 5. CONSUMER ENDPOINTS
###############################################################################

### Get Consumer Profile (requires Authorization - Consumer only)
GET {{baseUrl}}/consumers/profile/me
Authorization: Bearer your-consumer-jwt-token-here

### Update Consumer Profile (requires Authorization - Consumer only)
PUT {{baseUrl}}/consumers/profile/me
Authorization: Bearer your-consumer-jwt-token-here
Content-Type: {{contentType}}

{
  "preferences": {
    "preferredCategories": ["plumbing", "electrical"],
    "maxDistance": 30,
    "priceRange": {
      "min": 50,
      "max": 150
    }
  },
  "location": {
    "latitude": 40.7128,
    "longitude": -74.0060,
    "address": "New York, NY"
  },
  "searchRadius": 25
}

### Get Consumer Connections (requires Authorization - Consumer only)
GET {{baseUrl}}/consumers/connections/list?page=1&limit=20
Authorization: Bearer your-consumer-jwt-token-here

### Connect to Vendor (requires Authorization - Consumer only)
POST {{baseUrl}}/consumers/connections/connect
Authorization: Bearer your-consumer-jwt-token-here
Content-Type: {{contentType}}

{
  "vendorId": "vendor-id-here",
  "notes": "Interested in plumbing services"
}

### Get Favorites (requires Authorization - Consumer only)
GET {{baseUrl}}/consumers/favorites/list
Authorization: Bearer your-consumer-jwt-token-here

### Add to Favorites (requires Authorization - Consumer only)
POST {{baseUrl}}/consumers/favorites/add
Authorization: Bearer your-consumer-jwt-token-here
Content-Type: {{contentType}}

{
  "vendorId": "vendor-id-here"
}

###############################################################################
### 6. RATING ENDPOINTS
###############################################################################

### Create Rating (requires Authorization)
POST {{baseUrl}}/ratings/create
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "vendorId": "vendor-id-here",
  "costEffectiveness": 4,
  "qualityOfService": 5,
  "timelinessOfDelivery": 4,
  "professionalism": 5,
  "reviewTitle": "Excellent Service",
  "reviewText": "Very professional and timely service. Highly recommended!",
  "jobDescription": "Fixed kitchen sink leak",
  "jobValue": 150.00
}

### Get Ratings for Vendor (Public)
GET {{baseUrl}}/ratings/vendor/vendor-id-here?page=1&limit=10

### Get User's Given Ratings (requires Authorization)
GET {{baseUrl}}/ratings/my-ratings?page=1&limit=10
Authorization: Bearer your-jwt-token-here

### Update Rating (requires Authorization)
PUT {{baseUrl}}/ratings/rating-id-here
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "costEffectiveness": 5,
  "qualityOfService": 5,
  "reviewText": "Updated review - even better than expected!"
}

### Delete Rating (requires Authorization)
DELETE {{baseUrl}}/ratings/rating-id-here
Authorization: Bearer your-jwt-token-here

###############################################################################
### 7. INVITATION ENDPOINTS
###############################################################################

### Send SMS Invitation (requires Authorization)
POST {{baseUrl}}/invitations/send-sms
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "recipientPhone": "+1234567893",
  "message": "Join FixRx to connect with trusted service providers!"
}

### Send Email Invitation (requires Authorization)
POST {{baseUrl}}/invitations/send-email
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "recipientEmail": "friend@example.com",
  "message": "I found this great app for finding service providers. Check it out!"
}

### Send Bulk Invitations (requires Authorization)
POST {{baseUrl}}/invitations/send-bulk
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "invitations": [
    {
      "type": "SMS",
      "recipientPhone": "+1234567894",
      "message": "Join FixRx!"
    },
    {
      "type": "EMAIL",
      "recipientEmail": "another@example.com",
      "message": "Check out FixRx!"
    }
  ]
}

### Get Invitation History (requires Authorization)
GET {{baseUrl}}/invitations/history?page=1&limit=20
Authorization: Bearer your-jwt-token-here

### Get Invitation Statistics (requires Authorization)
GET {{baseUrl}}/invitations/stats
Authorization: Bearer your-jwt-token-here

###############################################################################
### 8. CONTACT ENDPOINTS
###############################################################################

### Import Contacts (requires Authorization)
POST {{baseUrl}}/contacts/import
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "contacts": [
    {
      "firstName": "John",
      "lastName": "Doe",
      "phone": "+1234567895",
      "email": "john@example.com"
    },
    {
      "firstName": "Jane",
      "lastName": "Smith",
      "phone": "+1234567896",
      "email": "jane@example.com"
    }
  ]
}

### Get Contacts (requires Authorization)
GET {{baseUrl}}/contacts/list?page=1&limit=50
Authorization: Bearer your-jwt-token-here

### Sync Contacts (requires Authorization)
POST {{baseUrl}}/contacts/sync
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "contacts": [
    {
      "firstName": "Updated",
      "lastName": "Contact",
      "phone": "+1234567897",
      "email": "updated@example.com"
    }
  ]
}

### Check Registration Status (requires Authorization)
POST {{baseUrl}}/contacts/check-registration
Authorization: Bearer your-jwt-token-here
Content-Type: {{contentType}}

{
  "phones": ["+1234567895", "+1234567896", "+1234567897"]
}

###############################################################################
### 9. FILE UPLOAD ENDPOINTS
###############################################################################

### Upload Profile Image (requires Authorization and multipart/form-data)
POST {{baseUrl}}/uploads/profile-image
Authorization: Bearer your-jwt-token-here
Content-Type: multipart/form-data

# Add file in the body with key "image"

### Upload Portfolio Images (requires Authorization - Vendor only)
POST {{baseUrl}}/uploads/portfolio
Authorization: Bearer your-vendor-jwt-token-here
Content-Type: multipart/form-data

# Add files in the body with key "images"

### Upload Certification (requires Authorization - Vendor only)
POST {{baseUrl}}/uploads/certification
Authorization: Bearer your-vendor-jwt-token-here
Content-Type: multipart/form-data

# Add file in the body with key "certification"

### Upload Review Images (requires Authorization)
POST {{baseUrl}}/uploads/review-images
Authorization: Bearer your-jwt-token-here
Content-Type: multipart/form-data

# Add files in the body with key "images"

###############################################################################
### 10. ADMIN ENDPOINTS (if implemented)
###############################################################################

### Get System Statistics (requires Authorization - Admin only)
GET {{baseUrl}}/admin/stats
Authorization: Bearer your-admin-jwt-token-here

### Get All Users (requires Authorization - Admin only)
GET {{baseUrl}}/admin/users?page=1&limit=50&role=VENDOR&status=ACTIVE
Authorization: Bearer your-admin-jwt-token-here

### Update User Status (requires Authorization - Admin only)
PUT {{baseUrl}}/admin/users/user-id-here/status
Authorization: Bearer your-admin-jwt-token-here
Content-Type: {{contentType}}

{
  "status": "SUSPENDED",
  "reason": "Policy violation"
}
